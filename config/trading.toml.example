# =============================================================================
# MojoRust Trading Bot Configuration - EXAMPLE TEMPLATE
# =============================================================================
# This is a template configuration file. To use it:
# 1. Copy this file to 'trading.toml': cp trading.toml.example trading.toml
# 2. Set environment variables for sensitive data (see .env.example)
# 3. Adjust trading parameters according to your risk tolerance
# 4. Never commit trading.toml with real credentials to version control
# =============================================================================

# =============================================================================
# Trading Environment
# =============================================================================
[environment]
trading_env = "development"  # development, staging, production
execution_mode = "paper"     # paper, live

# =============================================================================
# API Configuration
# =============================================================================
[api]
timeout_seconds = 10.0

# =============================================================================
# Trading Parameters
# =============================================================================
[trading]
initial_capital = 1.0        # SOL
max_position_size = 0.1      # 10% of portfolio per position
min_position_size = 0.01     # 1% of portfolio minimum
max_drawdown = 0.15          # 15% maximum drawdown
daily_trade_limit = 50       # Maximum trades per day
kelly_fraction = 0.5         # Kelly criterion fraction
max_portfolio_risk = 0.02    # 2% max portfolio risk per trade
cycle_interval = 1.0         # Trading cycle interval in seconds

# =============================================================================
# Strategy Configuration
# =============================================================================
[strategy]
rsi_period = 14
oversold_threshold = 25.0
overbought_threshold = 75.0
min_confluence_strength = 0.7
enable_arbitrage = true
enable_momentum = true
enable_mean_reversion = false
support_distance = 0.15
atr_multiplier = 1.5

# =============================================================================
# Risk Management Configuration
# =============================================================================
[risk]
max_position_risk = 0.02     # 2% risk per position
max_portfolio_risk = 0.05    # 5% total portfolio risk
max_correlation = 0.7        # Maximum correlation between positions
diversification_target = 10  # Target number of diversified positions

# =============================================================================
# Execution Configuration
# =============================================================================
[execution]
max_slippage = 0.03          # 3% maximum slippage
max_priority_fee = 0.001     # Maximum priority fee in SOL
transaction_timeout = 30     # Transaction timeout in seconds
retry_attempts = 3           # Number of retry attempts
confirmation_timeout = 30    # Block confirmation timeout
gas_optimization = true      # Enable gas optimization

# =============================================================================
# Circuit Breakers Configuration
# =============================================================================
[circuit_breakers]
max_drawdown = 0.15                    # 15% maximum drawdown before halt
max_consecutive_losses = 5             # Halt after 5 consecutive losses
max_daily_loss_percentage = 0.10       # 10% maximum daily loss
max_position_concentration = 0.30      # 30% maximum single position size
min_trade_interval_seconds = 60        # 60 seconds minimum between trades per symbol
rapid_drawdown_threshold = 0.05        # 5% drawdown in 5 minutes triggers halt

# =============================================================================
# Database Configuration (TimescaleDB/PostgreSQL)
# =============================================================================
[database]
enabled = true                         # Enable database persistence
host = "localhost"
port = 5432
database = "trading_bot"
user = "trader"
password_env = "DB_PASSWORD"           # Environment variable for password
max_connections = 10
batch_size = 100                       # Batch insert size
auto_flush_interval_seconds = 60       # Auto-flush every 60 seconds

# =============================================================================
# Alert System Configuration
# =============================================================================
[alerts]
enabled = true
channels = ["console", "webhook"]      # Available: console, webhook, telegram, email

# Webhook (Discord/Slack)
webhook_url_env = "DISCORD_WEBHOOK_URL"

# Telegram
telegram_bot_token_env = "TELEGRAM_BOT_TOKEN"
telegram_chat_id_env = "TELEGRAM_CHAT_ID"

# Alert cooldowns (seconds)
error_alert_cooldown = 60              # Max 1 error alert per minute
performance_alert_cooldown = 300       # Max 1 performance alert per 5 minutes
trade_alert_cooldown = 0               # No cooldown for trade alerts

# Thresholds
performance_alert_threshold = 0.05     # Alert if metric changes >5%

# =============================================================================
# Strategy Adaptation Configuration
# =============================================================================
[strategy_adaptation]
enabled = true
adaptation_interval_hours = 24         # Adapt every 24 hours
performance_window_hours = 48          # Analyze last 48 hours
min_trades_for_adaptation = 20         # Minimum trades before adapting

# Baseline parameters (what to adapt from)
baseline_confidence_threshold = 0.70   # 70% minimum confidence
baseline_position_size = 0.05          # 5% of portfolio per trade
baseline_stop_loss_percentage = 0.10   # 10% stop loss
baseline_take_profit_percentage = 0.20 # 20% take profit
baseline_max_positions = 5             # Maximum 5 concurrent positions

# Adaptation limits
max_confidence_threshold = 0.90        # Don't go above 90%
min_confidence_threshold = 0.50        # Don't go below 50%
max_position_size_multiplier = 1.5     # Max 150% of baseline
min_position_size_multiplier = 0.5     # Min 50% of baseline

# =============================================================================
# Filter Configuration
# =============================================================================
[filters]
# Instant Spam Detector (ultra-fast <10ms checks)
instant_min_volume_usd = 1000.0         # Minimum volume for instant filter
instant_min_liquidity_usd = 5000.0       # Minimum liquidity for instant filter
instant_min_confidence = 0.30            # Minimum confidence for instant filter
instant_extreme_rsi_low = 5.0            # Extreme oversold RSI threshold
instant_extreme_rsi_high = 95.0          # Extreme overbought RSI threshold

# Spam Filter (aggressive 90%+ rejection)
spam_min_volume_usd = 10000.0            # Minimum volume for spam filter
spam_min_liquidity_usd = 20000.0         # Minimum liquidity for spam filter
spam_min_confidence = 0.70               # Minimum confidence for spam filter
spam_cooldown_seconds = 30.0             # Cooldown between signals per symbol
spam_max_signals_per_symbol = 5          # Max signals per symbol
spam_volume_quality_threshold = 0.6      # Minimum volume quality score
spam_avg_tx_size_threshold = 10.0        # Minimum average transaction size
spam_volume_consistency_threshold = 0.3   # Minimum volume consistency
spam_volume_to_liquidity_ratio = 10.0    # Max volume/liquidity ratio
spam_wash_trading_threshold = 0.7        # Wash trading score threshold
spam_high_frequency_threshold = 100.0     # High frequency transaction threshold
spam_large_tx_count = 10                 # Large transaction count threshold
spam_large_tx_liquidity = 25000.0        # Liquidity threshold for large tx
spam_extreme_rsi_threshold = 80.0        # Extreme RSI for pump detection
spam_rapid_price_change = 50.0           # Rapid price change % (5min)
spam_high_confidence_new_token = 0.8     # High confidence for new tokens
spam_new_token_age_hours = 0.5           # Very new token threshold
spam_careful_token_age_hours = 2.0       # Careful token age threshold
spam_expected_return_limit = 10.0        # Max expected return multiplier
spam_min_stop_loss_distance = 0.05       # Minimum stop loss distance
spam_round_number_confidence = 0.85      # Confidence for round numbers

# Micro Timeframe Filter (ultra-strict for 1s-15s)
micro_min_volume_usd = 15000.0           # Micro timeframe minimum volume
micro_min_confidence = 0.75              # Micro timeframe minimum confidence
micro_cooldown_seconds = 60.0            # Micro timeframe cooldown
micro_min_price_stability = 0.80         # Minimum price stability
micro_max_price_change_5min = 0.30       # Max price change in 5min
micro_extreme_price_spike = 0.50         # Extreme price spike threshold
micro_volume_spike_ratio = 3.0           # Volume spike detection ratio
micro_extreme_price_change = 0.20        # Extreme price change for P&D
micro_max_holder_concentration = 0.80    # Max holder concentration
micro_min_liquidity_ratio = 0.5          # Min liquidity/volume ratio
micro_min_rsi = 20.0                     # Minimum acceptable RSI
micro_max_rsi = 80.0                     # Maximum acceptable RSI
micro_volume_consistency = 0.6           # Minimum volume consistency
micro_liquidity_multiplier = 1.5         # Liquidity should be 1.5x volume
micro_min_tx_size_ratio = 0.001          # Min transaction size ratio
micro_max_tx_size_ratio = 0.10           # Max transaction size ratio
micro_required_checks_percentage = 0.75   # Required checks pass rate

# =============================================================================
# Risk Thresholds Configuration
# =============================================================================
[risk_thresholds]
# RSI-based risk thresholds
rsi_extreme_overbought = 90.0            # Extreme overbought RSI
rsi_very_overbought = 80.0               # Very overbought RSI
rsi_extreme_oversold = 10.0              # Extreme oversold RSI
rsi_very_oversold = 20.0                 # Very oversold RSI
risk_score_extreme_overbought = 0.3      # Risk score for extreme overbought
risk_score_very_overbought = 0.2         # Risk score for very overbought
risk_score_extreme_oversold = 0.2        # Risk score for extreme oversold
risk_score_very_oversold = 0.1           # Risk score for very oversold

# Volume and liquidity risk
risk_score_low_volume = 0.3              # Risk score for low volume
risk_score_low_liquidity = 0.4           # Risk score for low liquidity
liquidity_risk_low_volume = 0.2          # Liquidity risk for low volume
liquidity_risk_low_liquidity = 0.3       # Liquidity risk for low liquidity

# Price movement risk
price_movement_extreme = 0.2             # Extreme price movement (20%)
price_movement_high = 0.1                # High price movement (10%)
risk_score_extreme_movement = 0.3        # Risk score for extreme movement
risk_score_high_movement = 0.2           # Risk score for high movement
volatility_extreme_movement = 0.3        # Volatility score for extreme
volatility_high_movement = 0.2           # Volatility score for high

# Confidence and wash trading
confidence_threshold = 0.6               # Low confidence threshold
risk_score_low_confidence = 0.2          # Risk score for low confidence
wash_trading_volume_threshold = 1000000.0 # Volume for wash trading check
wash_trading_liquidity_threshold = 10000.0 # Liquidity for wash trading
risk_score_wash_trading = 0.4            # Risk score for wash trading
wash_trading_score = 0.8                  # Wash trading score value

# Risk level thresholds
risk_level_critical = 0.7                # Critical risk level threshold
risk_level_high = 0.5                    # High risk level threshold
risk_level_medium = 0.3                  # Medium risk level threshold

# Position sizing multipliers
position_size_high_risk_multiplier = 0.5 # Multiplier for high risk
position_size_medium_risk_multiplier = 0.75 # Multiplier for medium risk
liquidity_risk_multiplier = 0.7          # Multiplier for liquidity risk
volatility_risk_multiplier = 0.8         # Multiplier for volatility risk
volatility_threshold = 0.3                # Volatility threshold
liquidity_risk_threshold = 0.5           # Liquidity risk threshold

# Liquidity checks
min_liquidity_check = 5000.0              # Minimum liquidity for check
volume_to_liquidity_suspicious = 20.0    # Suspicious volume/liquidity ratio

# Portfolio risk
correlation_risk_divisor = 10.0           # Divisor for correlation risk
concentration_risk_threshold = 0.3       # Concentration risk threshold
liquidity_risk_portfolio_multiplier = 0.1 # Portfolio liquidity multiplier
total_risk_critical = 0.7                # Total risk critical threshold
total_risk_high = 0.5                    # Total risk high threshold
total_risk_medium = 0.3                  # Total risk medium threshold
daily_trades_warning_percentage = 0.8    # Warning at 80% of daily limit

# =============================================================================
# Strategy Thresholds Configuration
# =============================================================================
[strategy_thresholds]
# Stop loss multipliers
stop_loss_below_support = 0.95           # Stop loss below support (5%)
stop_loss_above_resistance = 1.05        # Stop loss above resistance (5%)
stop_loss_momentum_buy = 0.93            # Stop loss for momentum buy (7%)
stop_loss_momentum_sell = 1.07           # Stop loss for momentum sell (7%)

# Price targets
price_target_momentum_buy = 1.1          # Price target momentum buy (10%)
price_target_momentum_sell = 0.9         # Price target momentum sell (10%)

# Mean reversion
mean_reversion_upper_band = 1.1          # Upper band for mean reversion
mean_reversion_lower_band = 0.9          # Lower band for mean reversion
mean_reversion_buy_threshold = 1.02      # Buy near lower band (2%)
mean_reversion_sell_threshold = 0.98     # Sell near upper band (2%)
mean_reversion_stop_loss_buy = 0.95      # Stop loss mean reversion buy
mean_reversion_stop_loss_sell = 1.05     # Stop loss mean reversion sell
mean_reversion_confidence = 0.7          # Mean reversion confidence

# Momentum
momentum_threshold = 0.02                # Momentum threshold (2% in 5min)
momentum_confidence_multiplier = 10.0     # Confidence multiplier
momentum_max_confidence = 0.8            # Max momentum confidence

# Confidence calculation
base_confidence = 0.5                    # Base confidence for RSI signals
confluence_boost_multiplier = 0.3        # Confluence boost multiplier
rsi_boost_multiplier = 0.2               # RSI extremity boost
distance_boost_max = 0.1                 # Max distance boost
distance_boost_divisor = 0.1             # Distance boost divisor

# Signal scoring
volume_bonus_divisor = 100000.0          # Volume bonus divisor
volume_bonus_max = 0.1                   # Max volume bonus
liquidity_bonus_divisor = 50000.0        # Liquidity bonus divisor
liquidity_bonus_max = 0.1                # Max liquidity bonus
risk_reward_bonus_max = 0.2              # Max risk-reward bonus
risk_reward_bonus_divisor = 10.0         # Risk-reward bonus divisor

# Exit conditions
position_age_exit_hours = 4.0            # Exit position after hours
exit_urgency_stop_loss = 1.0             # Stop loss urgency
exit_urgency_take_profit = 0.8           # Take profit urgency
exit_urgency_time_based = 0.6            # Time-based exit urgency
exit_confidence_stop_loss = 1.0          # Stop loss confidence
exit_confidence_take_profit = 0.9        # Take profit confidence
exit_confidence_time_based = 0.7         # Time-based exit confidence

# Sentiment adjustments
sentiment_positive_threshold = 0.3       # Positive sentiment threshold
sentiment_negative_threshold = -0.3      # Negative sentiment threshold
sentiment_very_negative = -0.5           # Very negative sentiment
sentiment_confidence_boost = 0.1         # Sentiment confidence boost
sentiment_confidence_penalty = 0.2       # Sentiment confidence penalty

# =============================================================================
# Legacy Monitoring Configuration (for compatibility)
# =============================================================================
[monitoring]
prometheus_port = 9090
log_level = "INFO"
log_format = "json"
metrics_interval = 60
enable_alerts = true
alert_webhook_url = ""

# =============================================================================
# Telegram Alerts Configuration
# =============================================================================
# ⚠️ SECURITY: Never hardcode tokens. Always use environment variables.

[telegram]
enabled = true
token = "${TELEGRAM_BOT_TOKEN}"            # Get from @BotFather on Telegram
chat_id = "${TELEGRAM_CHAT_ID}"           # Get from @userinfobot on Telegram
parse_mode = "HTML"

# Alert types to enable
enable_trade_alerts = true
enable_risk_alerts = true
enable_performance_alerts = true
enable_system_alerts = true

# Message formatting
include_chart_links = false
max_message_length = 4096
rate_limit_seconds = 3

# Alert thresholds
min_trade_value_usd = 100.0
max_alerts_per_hour = 20
quiet_hours_start = "22:00"
quiet_hours_end = "08:00"

# =============================================================================
# Additional API Configuration Sections
# =============================================================================

# Solana RPC Configuration
[solana]
rpc_url_env = "SOLANA_RPC_URL"            # Solana RPC endpoint
commitment = "confirmed"                  # confirmed, finalized, processed

# Helius API Configuration
[helius]
api_key_env = "HELIUS_API_KEY"            # Helius API key
base_url = "https://api.helius.xyz"

# Jupiter API Configuration
[jupiter]
base_url = "https://quote-api.jup.ag/v6"
api_base_url = "https://price.jup.ag/v3"  # Price API
quote_api_base_url = "https://quote-api.jup.ag/v6"  # Quote API
timeout_seconds = 10
rate_limit_delay_ms = 100
batch_size = 50
max_retries = 3
retry_delay_ms = 1000

# DexScreener API Configuration
[dexscreener]
api_key_env = "DEXSCREENER_API_KEY"       # Optional API key
base_url = "https://api.dexscreener.com"

# Birdeye API Configuration
[birdeye]
api_key_env = "BIRDEYE_API_KEY"           # Birdeye API key
base_url = "https://api.birdeye.so"

# =============================================================================
# Arbitrage Configuration
# =============================================================================
[arbitrage]
enabled = true
scan_interval_ms = 1000
min_profit_threshold = 10.0
max_gas_cost_sol = 0.01
max_slippage_bps = 100
engine_timeout_seconds = 30
price_cache_ttl_seconds = 30
max_concurrent_opportunities = 5

# Monitored tokens and DEXes
monitored_tokens = [
    "So11111111111111111111111111111111111111112",  # SOL
    "EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"   # USDC
]

monitored_dexes = [
    "raydium",
    "orca",
    "serum"
]

# Arbitrage types
enable_triangular = true
enable_cross_dex = true
enable_statistical = false
enable_flash_loan = false